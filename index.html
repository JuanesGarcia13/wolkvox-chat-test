<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Chat Wolkvox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <script type="text/javascript">
    // 1. LIMPIEZA TOTAL AL CARGAR
    (function() {
      try {
        localStorage.clear();
        sessionStorage.clear();
        // Borramos cookies para que no reconozca la sesión anterior
        document.cookie.split(";").forEach(function(c) { 
          document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
        });
      } catch (e) {}
    })();
  </script>
</head>
<body>

<script
  id="prodId"
  type="text/javascript"
  src="https://widget01.wolkvox.com/chat/?prodId=c3VtbWEtbWFjLWNhLjIzNjI="
  async>
</script>
<script type="text/javascript">
  // 2. DETECTOR DE ESTADO "CONGELADO"
  // Si pasan 7 segundos y no hay rastro del chat, refrescamos.
  // 7 segundos es suficiente para que cargue, si tarda más es que se quedó en blanco.
  setTimeout(function() {
    var iframeChat = document.querySelector('iframe');
    if (!iframeChat) {
      window.location.reload();
    }
  }, 7000);

  // 3. LIMPIEZA CÍCLICA (Cada 30 segundos limpia el storage en segundo plano)
  // Esto ayuda a que, si el usuario cierra el chat, los datos de "Recordarme" 
  // que se filtran a nuestro dominio se borren solos.
  setInterval(function() {
    localStorage.clear();
  }, 30000);
</script>

</body>
</html>
